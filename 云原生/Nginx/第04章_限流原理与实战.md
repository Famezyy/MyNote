# 第04章_限流原理与实战

限流技术用来控制在高并发、大流量的场景中服务接口请求的速率，例如秒杀、抢购等场景。假设某个接口能够扛住的 QPS 为 10000，此时有 20000 个请求进来，经过限流模块，会先放 10000 个请求，其余的请求会阻塞一段时间，不至于返回 404。



## 1.限流策略原理与参考实现

接口限流的算法主要有以下 3 种：

- **计数器**：在一段时间窗口内，处理请求的最大数量固定，超过部分不做处理
- **漏桶**：漏桶大小固定，处理速度固定，但请求进入的速度不固定（请求过多时多余的会被丢弃）
- **令牌桶**：令牌桶大小固定，令牌产生速度固定，但是消耗令牌的速度不固定；每个请求都会从令牌桶中取出令牌，如果没有令牌就丢弃这次请求

### 1.1 计数器限流

```java

```

### 1.2 漏统限流

### 1.3 令牌桶限流

## 2.分布式计数器限流

## 3.Nginx漏统限流

## 4.实战：分布式令牌桶限流

## 5.实战：秒杀