# 面试

## ava工程师 - 模拟面试 - 直播回放

1. redis、zookeeper 解决分布式锁

2. 项目排查错误

redis 失去响应，本来应该无影响，刚开始服务也是好的，后来服务一直报错，后来发现是 actuator 在不停地做 health check

OOM：log 了大量信息，例如 response

3. **分布式链路追踪：Grafana**

在分布式链路跟踪中有两个重要的概念：**跟踪**（trace）和 **跨度**（ span）。trace 是请求在分布式系统中的整个链路视图，span 则代表整个链路中不同服务内部的视图，span 组合在一起就是整个 trace 的视图。

一般是在请求到达网关的开始，生成本次请求的 traceId 和 在网关服务内的 spanId ，将他们放在 HTTP 请求头或者 RPC 调用的元数据里，在调用下游服务时继续向下传递。下游的 RESTful API 服务的全局路由中间件和 RPC 服务的拦截器里会接收请求携带的 traceid 和生成当次请求在服务内部的 spanid，从上游接收到的 spanid 在这里会被转换成 pspanid。除此之外我们甚至可以把 traceid 和 spanid 注入到一些数据库连接池应用里，让记录的慢 SQL 日志里同样能打上 traceid 和 spanid 信息，为请求的响应过慢提供有效的分析数据。

4. **分布式事务**

两阶段提交、TCC、消息中间件等。

案例：如果是在同一个项目中保证两张表的同时更新 -- 使用 spring 自带的事务管理即可。

5. 秒杀

可以向 CDN 存入时间戳，这样用户可以直接通过 CDN 获取倒计时时间，但是不能由 CDN 生成时间戳，因为不能保证所有 CDN 服务器的时间戳相同。